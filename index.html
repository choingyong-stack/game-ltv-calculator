<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëª¨ë°”ì¼ ê²Œì„ LTV ê³„ì‚°ê¸°</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Apple SD Gothic Neo', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: rgba(15, 23, 42, 0.95);
            border-radius: 24px;
            padding: 35px;
            max-width: 650px;
            width: 100%;
            box-shadow: 0 25px 70px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(134, 239, 172, 0.1);
            border: 1px solid rgba(134, 239, 172, 0.15);
        }

        h1 {
            text-align: center;
            color: #86efac;
            margin-bottom: 10px;
            font-size: 28px;
            font-weight: 700;
            text-shadow: 0 2px 10px rgba(134, 239, 172, 0.3);
        }

        .subtitle {
            text-align: center;
            color: #94a3b8;
            font-size: 14px;
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 18px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #cbd5e1;
            font-size: 14px;
            font-weight: 500;
        }

        .input-wrapper {
            position: relative;
        }

        input[type="number"] {
            width: 100%;
            padding: 12px 40px 12px 15px;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(134, 239, 172, 0.25);
            border-radius: 12px;
            color: #e2e8f0;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #86efac;
            background: rgba(30, 41, 59, 0.8);
            box-shadow: 0 0 0 3px rgba(134, 239, 172, 0.15);
        }

        .unit {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
            font-size: 14px;
            pointer-events: none;
        }

        .chart-container {
            margin-top: 30px;
            padding: 25px;
            background: rgba(30, 41, 59, 0.4);
            border-radius: 16px;
            border: 1px solid rgba(134, 239, 172, 0.2);
        }

        .chart-title {
            text-align: center;
            color: #86efac;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .results {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, rgba(134, 239, 172, 0.1) 0%, rgba(110, 231, 183, 0.1) 100%);
            border-radius: 16px;
            border: 1px solid rgba(134, 239, 172, 0.25);
        }

        .result-title {
            text-align: center;
            color: #86efac;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 12px;
            margin-bottom: 12px;
            border: 1px solid rgba(134, 239, 172, 0.1);
        }

        .result-item:last-child {
            margin-bottom: 0;
        }

        .result-label {
            color: #cbd5e1;
            font-size: 14px;
        }

        .result-value {
            color: #86efac;
            font-size: 24px;
            font-weight: 700;
            text-shadow: 0 2px 8px rgba(134, 239, 172, 0.2);
        }

        .info-box {
            margin-top: 20px;
            padding: 16px;
            background: rgba(110, 231, 183, 0.08);
            border-radius: 12px;
            border-left: 3px solid #6ee7b7;
        }

        .info-box p {
            color: #94a3b8;
            font-size: 12px;
            line-height: 1.7;
        }

        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 20px;
            }

            .result-value {
                font-size: 18px;
            }
        }

        /* Remove number input arrows */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® ëª¨ë°”ì¼ ê²Œì„ LTV ê³„ì‚°ê¸°</h1>
        <p class="subtitle">ë¦¬í…ì…˜ ê¸°ë°˜ ê°„ì´ ê³„ì‚°</p>

        <div class="input-group">
            <label for="dau">DAU (ì¼ì¼ í™œì„± ìœ ì €)</label>
            <div class="input-wrapper">
                <input type="number" id="dau" value="10000" min="0" step="100">
                <span class="unit">ëª…</span>
            </div>
        </div>

        <div class="input-group">
            <label for="arpu">ARPU (ìœ ì €ë‹¹ í‰ê·  ë§¤ì¶œ)</label>
            <div class="input-wrapper">
                <input type="number" id="arpu" value="0.5" min="0" step="0.01">
                <span class="unit">$</span>
            </div>
        </div>

        <div class="input-group">
            <label for="d1">D1 ë¦¬í…ì…˜</label>
            <div class="input-wrapper">
                <input type="number" id="d1" value="40" min="0" max="100" step="0.1">
                <span class="unit">%</span>
            </div>
        </div>

        <div class="input-group">
            <label for="d7">D7 ë¦¬í…ì…˜</label>
            <div class="input-wrapper">
                <input type="number" id="d7" value="15" min="0" max="100" step="0.1">
                <span class="unit">%</span>
            </div>
        </div>

        <div class="input-group">
            <label for="d30">D30 ë¦¬í…ì…˜</label>
            <div class="input-wrapper">
                <input type="number" id="d30" value="5" min="0" max="100" step="0.1">
                <span class="unit">%</span>
            </div>
        </div>

        <div class="chart-container">
            <div class="chart-title">ğŸ“ˆ ë¦¬í…ì…˜ ì»¤ë¸Œ</div>
            <canvas id="retentionChart"></canvas>
        </div>

        <div class="results">
            <div class="result-title">ğŸ“Š ì˜ˆìƒ LTV</div>
            <div class="result-item">
                <span class="result-label">1ì¼ LTV (ìœ ì €ë‹¹)</span>
                <span class="result-value" id="ltv1">$0.00</span>
            </div>
            <div class="result-item">
                <span class="result-label">3ì¼ LTV (ìœ ì €ë‹¹)</span>
                <span class="result-value" id="ltv3">$0.00</span>
            </div>
            <div class="result-item">
                <span class="result-label">7ì¼ LTV (ìœ ì €ë‹¹)</span>
                <span class="result-value" id="ltv7">$0.00</span>
            </div>
            <div class="result-item">
                <span class="result-label">14ì¼ LTV (ìœ ì €ë‹¹)</span>
                <span class="result-value" id="ltv14">$0.00</span>
            </div>
            <div class="result-item">
                <span class="result-label">30ì¼ LTV (ìœ ì €ë‹¹)</span>
                <span class="result-value" id="ltv30">$0.00</span>
            </div>
        </div>

        <div class="info-box">
            <p>
                ğŸ’¡ <strong>ê³„ì‚° ë°©ì‹:</strong> ë¦¬í…ì…˜ ì»¤ë¸Œë¥¼ ì„ í˜• ë³´ê°„í•˜ì—¬ ê° ë‚ ì§œì˜ í™œì„± ìœ ì € ë¹„ìœ¨ì„ ì¶”ì •í•˜ê³ ,
                ì¼ë³„ ARPUë¥¼ ì ë¶„í•˜ì—¬ LTVë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤. ì‹¤ì œ LTVëŠ” ìœ ì € í–‰ë™ íŒ¨í„´ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
        </div>
    </div>

    <script>
        // ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ì „ì—­ ë³€ìˆ˜
        let retentionChart = null;

        // ë¦¬í…ì…˜ ê°’ì„ ì„ í˜• ë³´ê°„í•˜ëŠ” í•¨ìˆ˜
        function interpolateRetention(day, d1, d7, d30) {
            if (day === 0) return 100;
            if (day === 1) return d1;
            if (day === 7) return d7;
            if (day === 30) return d30;

            // êµ¬ê°„ë³„ ì„ í˜• ë³´ê°„
            if (day < 1) {
                return 100 + (d1 - 100) * day;
            } else if (day < 7) {
                return d1 + (d7 - d1) * (day - 1) / 6;
            } else if (day < 30) {
                return d7 + (d30 - d7) * (day - 7) / 23;
            } else {
                // 30ì¼ ì´í›„ëŠ” ì§€ìˆ˜ ê°ì‡  ê°€ì •
                const decayRate = 0.98;
                return d30 * Math.pow(decayRate, day - 30);
            }
        }

        // LTV ê³„ì‚° í•¨ìˆ˜ (ë¦¬í…ì…˜ ì»¤ë¸Œ ì ë¶„ ë°©ì‹)
        function calculateLTV(days, arpu, d1, d7, d30) {
            let ltv = 0;

            // Day 0ë¶€í„° ì‹œì‘ (ì²«ë‚  = 100% ë¦¬í…ì…˜)
            for (let day = 0; day <= days; day++) {
                const retention = interpolateRetention(day, d1, d7, d30) / 100;
                ltv += retention * arpu;
            }

            return ltv;
        }

        // ì°¨íŠ¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateChart(d1, d7, d30) {
            const days = [];
            const retentionData = [];

            // 0ì¼ë¶€í„° 30ì¼ê¹Œì§€ ë¦¬í…ì…˜ ë°ì´í„° ìƒì„±
            for (let day = 0; day <= 30; day++) {
                days.push(`D${day}`);
                retentionData.push(interpolateRetention(day, d1, d7, d30));
            }

            if (retentionChart) {
                // ê¸°ì¡´ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
                retentionChart.data.labels = days;
                retentionChart.data.datasets[0].data = retentionData;
                retentionChart.update('none'); // ì• ë‹ˆë©”ì´ì…˜ ì—†ì´ ì—…ë°ì´íŠ¸
            } else {
                // ì°¨íŠ¸ ì´ˆê¸°í™”
                const ctx = document.getElementById('retentionChart').getContext('2d');
                retentionChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: days,
                        datasets: [{
                            label: 'ë¦¬í…ì…˜ (%)',
                            data: retentionData,
                            borderColor: '#86efac',
                            backgroundColor: 'rgba(134, 239, 172, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointRadius: 4,
                            pointBackgroundColor: '#86efac',
                            pointBorderColor: '#0f172a',
                            pointBorderWidth: 2,
                            pointHoverRadius: 6,
                            pointHoverBackgroundColor: '#6ee7b7',
                            pointHoverBorderColor: '#86efac',
                            pointHoverBorderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 2,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.95)',
                                titleColor: '#86efac',
                                bodyColor: '#e2e8f0',
                                borderColor: '#86efac',
                                borderWidth: 1,
                                padding: 12,
                                displayColors: false,
                                callbacks: {
                                    label: function(context) {
                                        return `ë¦¬í…ì…˜: ${context.parsed.y.toFixed(2)}%`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    color: 'rgba(134, 239, 172, 0.1)',
                                    drawBorder: false
                                },
                                ticks: {
                                    color: '#94a3b8',
                                    maxRotation: 45,
                                    minRotation: 45,
                                    callback: function(value, index) {
                                        // 0, 1, 7, 14, 21, 30ì¼ë§Œ í‘œì‹œ
                                        if ([0, 1, 7, 14, 21, 30].includes(index)) {
                                            return this.getLabelForValue(value);
                                        }
                                        return '';
                                    }
                                }
                            },
                            y: {
                                beginAtZero: true,
                                max: 100,
                                grid: {
                                    color: 'rgba(134, 239, 172, 0.1)',
                                    drawBorder: false
                                },
                                ticks: {
                                    color: '#94a3b8',
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        }
                    }
                });
            }
        }

        // ê²°ê³¼ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateResults() {
            const dau = parseFloat(document.getElementById('dau').value) || 0;
            const arpu = parseFloat(document.getElementById('arpu').value) || 0;
            const d1 = parseFloat(document.getElementById('d1').value) || 0;
            const d7 = parseFloat(document.getElementById('d7').value) || 0;
            const d30 = parseFloat(document.getElementById('d30').value) || 0;

            // ì…ë ¥ê°’ ê²€ì¦
            if (d1 < 0 || d7 < 0 || d30 < 0 || d1 > 100 || d7 > 100 || d30 > 100) {
                return;
            }

            // LTV ê³„ì‚°
            const ltv1 = calculateLTV(1, arpu, d1, d7, d30);
            const ltv3 = calculateLTV(3, arpu, d1, d7, d30);
            const ltv7 = calculateLTV(7, arpu, d1, d7, d30);
            const ltv14 = calculateLTV(14, arpu, d1, d7, d30);
            const ltv30 = calculateLTV(30, arpu, d1, d7, d30);

            // ê²°ê³¼ í‘œì‹œ
            document.getElementById('ltv1').textContent = `$${ltv1.toFixed(2)}`;
            document.getElementById('ltv3').textContent = `$${ltv3.toFixed(2)}`;
            document.getElementById('ltv7').textContent = `$${ltv7.toFixed(2)}`;
            document.getElementById('ltv14').textContent = `$${ltv14.toFixed(2)}`;
            document.getElementById('ltv30').textContent = `$${ltv30.toFixed(2)}`;

            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            updateChart(d1, d7, d30);
        }

        // ëª¨ë“  ì…ë ¥ í•„ë“œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        const inputs = document.querySelectorAll('input[type="number"]');
        inputs.forEach(input => {
            input.addEventListener('input', updateResults);
        });

        // ì´ˆê¸° ê³„ì‚° ì‹¤í–‰
        updateResults();
    </script>
</body>
</html>